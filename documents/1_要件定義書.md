# 要件定義書
## 1. プロジェクト概要
### アプリ名
dqwfunモンスターウォーカー（MonsterWalker）

### アプリコンセプト
- ドラクエウォークのモンスターの攻略武器、キャラを登録し、共有する。
- 情報登録者は、モンスターの攻略編成を登録・共有することで、コミュニティ内での認知度向上と貢献者としての満足感を得ることができる。
- 情報利用者は、自身の保有する武器条件に基づいて最適な攻略編成を検索でき、効率的な攻略情報の取得が可能となる。
- 攻略情報の閲覧はログイン不要で誰でも可能。登録・いいね等の機能はログインが必要。
- 個人運営のため、マスタデータの完全な保守は困難である。利用者からの要望を受け付け、継続的に改善を行う運営方針とする。

### ビジネス戦略
- 無料

### 収益モデル
- なし

### ターゲットユーザー
- ドラクエウォークアプリユーザ

### 想定規模
- 個人開発プロジェクト
- 目標ユーザー数: ～1,000人

## 2. 機能要件

### 2.1 基本機能
- ユーザ認証
  - Supabaseによる「メールアドレス/パスワード」によるユーザ認証
  - Supabaseによる「X（旧Twitter）」によるユーザ認証
  - 前回ログイン時のログイン情報の記憶機能により、次回以降オートログイン可能

- ログイン要否
  | 機能 | ログイン |
  |------|----------|
  | 攻略情報の検索・閲覧 | 不要 |
  | 攻略情報の登録・編集・削除 | 必要 |
  | いいね | 必要 |
  | お気に入り登録 | 必要 |
  | 通報 | 必要 |
  | 要望送信 | 必要 |
  | 要望一覧閲覧 | 不要 |
  | アカウント削除 | 必要 |

  ※未ログイン状態でログイン必須機能を実行しようとした場合、ログイン画面に遷移する

- モンスター攻略情報登録
  下記情報を登録可能とする。
  - 攻略対象モンスター
  - パーティーメンバー4人の構成。1名ずつ下記項目を登録
    - 武器
    - 職業
    - 役割（火力/回復/壁/バフ/任意）
    - 装備画面のスクリーンショット。1名につき2画像（装備の表・裏）。
  - パーティの行動順序、行動内容。
  - 攻略タイプ（ワンパン/セミオート/オート）
  なお、登録時に使用するモンスター名、武器などのマスタ情報は別のNext.jsを使った社内ポータルサイトからメンテナンスとしこの要件定義のスコープ外とする。


- モンスター攻略情報検索
  「攻略対象モンスター」「武器」をキーに攻略情報を検索する。
  検索結果は一覧表示し、「いいね」数順にソート表示する。
  検索条件はお気に入り登録可能。
  クリックすると個別画面を表示する。個別画面ではお気に入り登録可能。
  個別画面では、登録者プロフィール画面への遷移が可能。
  高速かつ快適な検索体験を実現するため、Supabaseから取得したデータはクライアント端末にキャッシュする。

- いいね機能
  - 攻略情報に対して「いいね」を付与できる
  - 同一ユーザーが同一攻略情報に複数回いいねすることはできない
  - いいねの取り消しが可能

- 通報機能
  - 不正・不適切な攻略情報を通報できる
  - 詳細は「2.3 不正データ対策」を参照


- お気に入り一覧
  - 「検索条件」のお気に入り一覧、「モンスター攻略情報」のお気に入り一覧をタブシートで分けて表示
  - お気に入りの順序変更、削除が可能

- ランキング
  - モンスター攻略情報の「いいね」数のランキング
  - 登録者別のモンスター攻略情報件数の週間、累計ランキング
  - 登録者のプロフィール画面へのリンク


- マイページ
  - プロフィール編集
    - ニックネーム
    - アイコン画像
    - Xアカウント名
  - プロフィール表示
  - アカウント削除
    - アカウントと関連する全てのデータを削除
    - 削除前に確認ダイアログを表示
    - 削除後は復元不可

- 要望受付機能
  - マスタデータ（モンスター、武器等）の追加・修正要望を受け付ける
  - 要望送信にはログインが必要
  - 要望内容は運営者へ通知され、確認後に対応を行う
  - 要望フォームはマイページから遷移可能
  - 要望一覧画面
    - 全利用者からの要望一覧を閲覧可能（ログイン不要）
    - 各要望の対応状況（未対応/対応中/対応完了/対応不可）を表示
    - 運営者からの回答コメントを表示

- ボトムメニュー構成
  - ホーム（検索機能）
  - お気に入り一覧（「検索条件」、「モンスター攻略情報」）
  - 登録
  - ランキング
  - マイページ


### 2.2 画面階層構造
```
アプリルート
│
├── 認証フロー（ログイン必須機能実行時に遷移）
│   ├── スプラッシュ画面 (A01)
│   ├── ログイン画面 (A02)
│   └── サインアップ画面 (A03)
│
└── メインアプリ（5タブナビゲーション）
    ├── 【ホームタブ】検索画面 (H01) → 検索結果一覧 (H02) → 攻略情報詳細 (H03) / ユーザープロフィール (H04)
    ├── 【お気に入りタブ】お気に入り一覧画面 (F01)
    ├── 【登録タブ】攻略情報登録画面 (R01)
    ├── 【ランキングタブ】ランキング画面 (K01)
    └── 【マイページタブ】マイページ (M01) → プロフィール編集 (M02) / 攻略情報一覧 (M03) → 攻略情報編集 (M04) / 要望送信 (M05) / 要望一覧 (M06)
```


### 2.3 不正データ対策（通報機能）
- **不正攻略情報通報**: 悪意を持ったユーザが不正な攻略情報を登録した場合を想定。他のユーザから通報を可能とする。
- **通報の重複防止**: 同一ユーザーが同一攻略情報に対して複数回通報できないようにする。
- **通報履歴**: 通報された攻略情報と通報したユーザーの履歴を保持する。
- **管理者対応**: 通報内容の確認および攻略情報の無効化・ユーザー利用停止等の対応は、別途管理用アプリにて管理者が実施する。

## 3. 非機能要件
### 3.1 パフォーマンス
- アプリ起動時間: 3秒以内
- 検索結果表示: 2秒以内

### 3.2 セキュリティ
- **DBのデータ保護**:
  - データ登録、削除はRow Level Security (RLS)により、認証済みユーザのみ自分のデータを操作可能とする。
  - データ参照はクライアント端末からSupabaseのpublicスキーマのデータを直接参照可能とする（全員閲覧可能）。
- **データ暗号化**:
  - パスワード：Supabase保存時のハッシュ化（bcrypt等）
  - 個人情報：存在しない
  - 通信：HTTPS/TLS暗号化
- **画像アップロード**:
  - スクリーンショットはSupabase Storageに保存
  - ファイルサイズ上限: 5MB/枚
- **リスク認識（データスクレイピング）**:
  - RLSで参照を全員許可としているため、悪意のある第三者がSupabaseのURLとanon keyを取得し、APIを直接呼び出してデータを一括取得するリスクがある。
  - 対象データ: 攻略情報、ニックネーム、Xアカウント名、アイコン画像URL等
  - 許容理由:
    - 元々公開・共有目的のデータであり機密性は低い
    - 個人情報を保持しない設計
    - 個人開発・小規模運用のファンツール
  - 将来的にRate Limiting（API呼び出し制限）の導入を検討可能

### 3.3 スケーラビリティ
- 1,000人のアクティブユーザーに対応

### 3.4 運営・保守
- **サポート体制**: 個人のベストエフォート
- **システム監視**: 個人のベストエフォート
- **データバックアップ**: 日次自動バックアップ
- **セキュリティ監視**: 個人のベストエフォート

### 3.5 UI/UX要件
- **デザイン方針**: シンプルで直感的なUI。攻略情報の検索・登録が迷わず行える設計。
- **基本画面構成**: 5タブナビゲーション（ホーム/お気に入り/登録/ランキング/マイページ）
- **操作性**: 片手操作を考慮したボタン配置
- **レスポンシブデザイン**: iOS/Android両対応
- **アクセシビリティ**: 特別な配慮は行わない（標準レベル）

### 3.6 データ管理要件
- **データ保存期間**: 後日検討
- **バックアップ方針**: 日次自動バックアップのみ実装
- **GDPR等海外対応**: 現段階では考慮対象外（日本国内向けサービスとして開始）
- **データ削除**: ユーザーアカウント削除時の基本的なデータ削除のみ実装

## 4. 法的・運営上の注意事項

### 4.1 法的コンプライアンス
- ドラクエウォークの利用規約を破らないこと。あくまでもファンツール。

### 4.2 コンテンツモデレーション
- **フリーコメント項目**:
  - 「行動順序・内容入力」
  - 「ニックネーム」
- **不適切文言チェック（クライアント側）**:
  - 登録時にNGワードリストとの照合を行い、不適切な文言を含む場合は登録を拒否
  - NGワードリストは管理用アプリでメンテナンス
- **不適切コンテンツ対策**: 通報機能により不適切な内容はユーザーコミュニティで検知、管理者が対応
- 不正な攻略情報に対しては、ユーザーコミュニティによる通報機能で対応
- 通報機能の悪用（虚偽通報）に対しては、管理者による手動対応

### 4.3 カスタマーサポート体制
- **問い合わせ窓口**: GitHubのIssueによる問い合わせ
- **対応内容**: バグ報告、機能要望、その他問い合わせ
- **対応言語**: 日本語のみ
- **レスポンス目標**: 個人開発のためベストエフォート
